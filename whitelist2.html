<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NUMA ACA - Whitelist Application</title>
    <style>
      /* Base positioning for cards and display */
      .card-1 {
        position: absolute;
        height: 25rem;
        right: 25px;
      }

      .card-2 {
        position: absolute;
        height: 35rem;
        right: 120px;
      }

      .units-display {
        position: absolute;
        height: 6rem;
        right: 520px;
        top: 280px;
      }

      @media (min-height: 900px) {
        .card-1,
        .card-2 {
          bottom: 30vh;
        }
        .units-display {
          top: 20vh;
        }
      }

      @media (min-height: 990px) {
        .card-1,
        .card-2 {
          bottom: 35vh;
          transform: scale(1.1);
        }
        .card-1 {
          right: 100px;
        }
        .card-2 {
          right: 200px;
        }
        .units-display {
          top: 30%;
          right: 700px;
        }
      }

      @keyframes float {
        0% {
          transform: translateY(0px) rotate(0deg);
        }
        25% {
          transform: translateY(-4px) rotate(1deg);
        }
        75% {
          transform: translateY(4px) rotate(-1deg);
        }
        100% {
          transform: translateY(0px) rotate(0deg);
        }
      }

      @keyframes float3d {
        0% {
          transform: translate3d(0, 0, 0) rotate3d(0, 0, 0, 0deg);
        }
        25% {
          transform: translate3d(0, -4px, 0) rotate3d(1, 1, 0, 2deg);
        }
        75% {
          transform: translate3d(0, 4px, 0) rotate3d(-1, -1, 0, -2deg);
        }
        100% {
          transform: translate3d(0, 0, 0) rotate3d(0, 0, 0, 0deg);
        }
      }

      .floating-3d {
        animation: float3d 4s ease-in-out infinite;
        will-change: transform;
        backface-visibility: hidden;
        transform-style: preserve-3d;
        perspective: 1000px;
      }

      .scene {
        perspective: 1000px;
        transform-style: preserve-3d;
      }

      .floating {
        animation: float 6s ease-in-out infinite;
      }

      .floating-delay-1 {
        animation-delay: -1s;
      }
      .floating-delay-2 {
        animation-delay: -2s;
      }
      .floating-delay-3 {
        animation-delay: -3s;
      }

      @font-face {
        font-family: "PolySans Median";
        src: url("/fonts/PolySans-Median.otf") format("opentype");
        font-weight: normal;
        font-style: normal;
      }

      @font-face {
        font-family: "PolySans Slim";
        src: url("/fonts/PolySans-Slim.otf") format("opentype");
        font-weight: normal;
        font-style: normal;
      }

      body {
        font-family: "PolySans Median", sans-serif;
        background-color: black;
        scrollbar-width: none;
      }
    </style>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body class="bg-black text-white font-sans min-h-screen relative">
    <!-- Background -->
    <div class="fixed inset-0 -z-10 min-h-screen overflow-hidden scene hidden lg:block">
      <img src="/assets/whitelist/Hero-BG.webp" alt="" class="absolute h-screen object-cover object-right-bottom right-0" />
      <!-- <img src="/assets/whitelist/NUMAPASS-2.webp" alt="" class="card-1 absolute floating floating-delay-2" /> -->
      <img src="/assets/whitelist/ACA1.webp" alt="" class="card-2 absolute floating" />
      <img src="/assets/whitelist/Units2.webp" alt="" class="units-display absolute" />
    </div>

    <!-- Top Bar -->
    <header class="flex justify-between items-center p-5"></header>

    <!-- Main Content -->
    <main class="flex flex-row min-h-[calc(100vh-80px)] z-10">
      <div class="w-full lg:w-1/2 flex flex-col items-center lg:items-start justify-center px-6 md:px-16 py-8 z-10 lg:ml-52">
        <img src="/assets/NUMA-logo.svg" alt="NUMA" class="w-28 mb-10" />
        <div>
          <img src="/assets/whitelist/badge2.webp" alt="M2" class="h-9" />
        </div>

        <!-- Header -->
        <div class="mb-8">
          <div class="flex items-center gap-4 my-5 md:mt-4">
            <img src="/assets/whitelist/passes.webp" alt="ACA" class="h-24 w-auto lg:hidden" />
            <div class="flex flex-col lg:flex-row items-center gap-0">
              <p class="text-xl text-left mt-4 mb-2">
                Whitelist Application // <span class="text-[#C4FF67] text-xl text-left mt-4 mb-2">ACA<span class="text-sm"> Adaptive Compute Unit</span></span>
              </p>
            </div>
          </div>

          <h1 class="text-4xl lg:text-5xl font-bold leading-tight text-center lg:text-left mb-0">
            The Portal Door<br />
            Is Now Open.
          </h1>
          <p class="mt-4 text-md text-white text-center lg:text-left pb-0">
            Your mission briefing will soon be delivered.<br />
            Are you ready to lead your team to victory?
          </p>
        </div>

        <div class="space-y-4 w-full max-w-[460px]">
          <!-- ETH Address Input -->
          <div class="bg-gray-800 p-4 rounded-lg flex items-start gap-4 lg:pr-16 relative">
            <img data-img="eth" class="absolute top-[60px] left-6 w-4 border border-[#C4FF67] rounded-full hidden" src="/assets/whitelist/check-icon.png" alt="check" />
            <div class="relative w-8 h-8 flex items-center justify-center">
              <img src="/assets/whitelist/NumberBullet.webp" alt="1" class="w-8 h-8" />
              <div class="absolute text-black font-bold">1</div>
            </div>
            <div class="flex-1">
              <label class="block font-semibold mb-2 text-left">Your ETH Address</label>
              <div class="flex items-center bg-black rounded-lg overflow-auto border-gray-500 border-2">
                <div class="py-3 flex items-center bg-gray-600 w-10 justify-center">
                  <img src="/assets/whitelist/EthLogo.png" alt="ETH" class="w-4 h-4" />
                </div>
                <input data-input="eth" type="text" placeholder="0x000..." class="w-full bg-transparent focus:outline-none pl-4" />
              </div>
            </div>
          </div>

          <!-- Twitter Handle Input -->
          <div class="bg-gray-800 p-4 rounded-lg flex items-start gap-4 lg:pr-16 relative">
            <img data-img="twitter" class="absolute top-[60px] left-6 w-4 border border-[#C4FF67] rounded-full hidden" src="/assets/whitelist/check-icon.png" alt="check" />
            <div class="relative w-8 h-8 flex items-center justify-center">
              <img src="/assets/whitelist/NumberBullet.webp" alt="2" class="w-8 h-8" />
              <div class="absolute text-black font-bold">2</div>
            </div>
            <div class="flex-1">
              <label class="block font-semibold mb-2 text-left">Your X (Twitter) Handle</label>
              <div class="flex items-center bg-black rounded-lg overflow-auto border-gray-500 border-2">
                <div class="py-3 flex items-center bg-gray-600 w-10 justify-center">
                  <img src="/assets/X-logo.svg" alt="X" class="w-4 h-4" />
                </div>
                <input data-input="twitter" type="text" placeholder="@handle" class="w-full bg-transparent focus:outline-none pl-4" />
              </div>
            </div>
          </div>

          <!-- Follow Button -->
          <div class="bg-gray-800 p-4 rounded-lg flex items-start gap-4 relative">
            <img data-img="follow" class="absolute top-[65px] left-6 w-4 border border-[#C4FF67] rounded-full hidden" src="/assets/whitelist/check-icon.png" alt="check" />
            <div class="relative w-8 h-8 flex items-center justify-center">
              <img src="/assets/whitelist/NumberBullet.webp" alt="3" class="w-8 h-8" />
              <div class="absolute text-black font-bold">3</div>
            </div>
            <div class="flex-1">
              <label class="block mb-2 text-left">Follow NUMA on X and make sure notifications are ON</label>
              <div class="lg:pr-11">
                <button data-button="follow" class="w-full flex items-center justify-center border border-[#C4FF67] text-[#C4FF67] rounded-lg px-4 py-2 mt-4 hover:bg-gray-700 transition-colors">
                  <img src="/assets/X-logo-lime.svg" class="w-4 h-4 mr-2" />
                  <span>Follow NUMA</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Repost Button -->
          <div class="bg-gray-800 p-4 rounded-lg flex items-start gap-4 relative">
            <img data-img="repost" class="absolute top-[65px] left-6 w-4 border border-[#C4FF67] rounded-full hidden" src="/assets/whitelist/check-icon.png" alt="check" />
            <div class="relative w-8 h-8 flex items-center justify-center">
              <img src="/assets/whitelist/NumberBullet.webp" alt="4" class="w-8 h-8" />
              <div class="absolute text-black font-bold">4</div>
            </div>
            <div class="flex-1">
              <label class="block mb-2 text-left">Quote tweet why you should be chosen.</label>
              <div class="lg:pr-11">
                <button data-button="repost" class="w-full flex items-center justify-center border border-[#C4FF67] text-[#C4FF67] rounded-lg px-4 py-2 mt-4 hover:bg-gray-700 transition-colors">
                  <img src="/assets/X-logo-lime.svg" class="w-4 h-4 mr-2" />
                  <span>Repost</span>
                </button>
              </div>
            </div>
          </div>

          <!-- Submit Button -->
          <div class="mt-6 w-full mb-24">
            <button disabled data-button="submit" class="bg-[#C4FF67] text-black rounded-lg px-6 py-3 font-medium transition-colors w-full hover:bg-gray-700 disabled:opacity-50 disabled:hover:bg-[#C4FF67]">Submit Application</button>
          </div>
          <div class="w-full h-[50px]"></div>
        </div>
      </div>
    </main>

    <!-- Modal -->
    <div id="modal" class="fixed inset-0 bg-black/70 backdrop-blur-sm hidden items-center justify-center z-50">
      <div class="bg-[#1E1E24] rounded-2xl p-8 w-[400px] flex flex-col items-center">
        <!-- Loading State -->
        <div id="modal-loading" class="py-8 hidden">
          <div class="w-8 h-8 border-4 border-[#C4FF67] border-t-transparent rounded-full animate-spin"></div>
        </div>

        <!-- Success State -->
        <div id="modal-success" class="py-8 flex flex-col items-center hidden">
          <div class="text-4xl mb-2">🎉</div>
          <h2 class="text-3xl font-bold mb-2">Success</h2>
          <p class="text-gray-400 text-center mb-8">Successfully submitted application.</p>
          <button onclick="closeModal()" class="w-full bg-[#C4FF67] text-black rounded-lg px-6 py-3 font-medium hover:bg-[#b3ff43] transition-colors">Close</button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script>
      const modal = document.getElementById("modal")
      const modalLoading = document.getElementById("modal-loading")
      const modalSuccess = document.getElementById("modal-success")
      const ethInput = document.querySelector('[data-input="eth"]')
      const twitterInput = document.querySelector('[data-input="twitter"]')
      const submitButton = document.querySelector('[data-button="submit"]')
      const followButton = document.querySelector('[data-button="follow"]')
      const repostButton = document.querySelector('[data-button="repost"]')
      const ethCheck = document.querySelector('[data-img="eth"]')
      const twitterCheck = document.querySelector('[data-img="twitter"]')
      const followCheck = document.querySelector('[data-img="follow"]')
      const repostCheck = document.querySelector('[data-img="repost"]')

      let followClicked = false
      let repostClicked = false
      let ethValid = false
      let twitterValid = false

      function showModal(state = "loading") {
        modal.classList.remove("hidden")
        modal.classList.add("flex")

        if (state === "loading") {
          modalLoading.classList.remove("hidden")
          modalSuccess.classList.add("hidden")
        } else {
          modalLoading.classList.add("hidden")
          modalSuccess.classList.remove("hidden")
        }
      }

      function closeModal() {
        modal.classList.add("hidden")
        modal.classList.remove("flex")
      }

      async function submitWhitelistInfo() {
        showModal("loading")

        try {
          const response = await fetch("https://server-production-c3f4.up.railway.app/api/users/submitWhitelistInfo", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              twitter: twitterInput.value.trim(),
              ethAddress: ethInput.value.trim(),
              version: 2,
            }),
          })

          if (!response.ok) {
            const error = await response.json()
            throw new Error(error.message || "Submission failed")
          }

          showModal("success")
        } catch (error) {
          console.error("Error:", error)
          alert(error.message)
          closeModal()
        }
      }

      function validateForm() {
        const ethRegex = /^0x[a-fA-F0-9]{40}$/
        ethValid = ethRegex.test(ethInput.value.trim())
        twitterValid = twitterInput.value.length > 1

        ethCheck.classList.toggle("hidden", !ethValid)
        twitterCheck.classList.toggle("hidden", !twitterValid)

        updateSubmitButton()
      }

      function updateSubmitButton() {
        const allValid = ethValid && twitterValid && followClicked && repostClicked
        submitButton.disabled = !allValid
      }

      followButton.addEventListener("click", function () {
        window.open("https://twitter.com/numasocial", "_blank")
        followClicked = true
        followCheck.classList.remove("hidden")
        updateSubmitButton()
      })

      repostButton.addEventListener("click", function () {
        window.open("https://twitter.com/intent/tweet?text=I want to be chosen for @numasocial because...", "_blank")
        repostClicked = true
        repostCheck.classList.remove("hidden")
        updateSubmitButton()
      })

      ethInput.addEventListener("input", validateForm)
      twitterInput.addEventListener("input", validateForm)
      submitButton.addEventListener("click", submitWhitelistInfo)
    </script>
  </body>
</html>
